<!-- Cabeçalho principal  -->
<%- include('../partials/header') %>

<!-- CONTEÚDO DO INDEX -->
<main class="container text-center mt-3">
    <h1>Lista de usuarios</h1>
    <!-- Criando um botão para página de cadastro -->
    <a href="/usuarios/cadastrar">
        <button class="btn btn-lg btn-primary">
            <!-- Utilizando um ícone do bootstrap -->
            <i class="bi bi-plus-circle"></i>
            cadastrar
        </button>
    </a>


    <!-- Criando a tabela de acordo com a lista de usuarios -->
     <% if (usuarios && usuarios.length > 0) { %>
      <!-- Criando a tabela -->
       <table class="table table-striped table-hover align-middle mt-5">
        <!-- cabeçalho da tabela -->
        <thead class="table-light">
         <tr class="text-center">
            <th scope="col"> ID</th>
            <th scope="col"> Usuário</th>
            <th scope="col"> Email</th>
            <th scope="col"> Tipo</th>
            <th scope="col"> Ações</th>
         </tr>
        </thead>
        <!-- corpo da tabela -->
        <tbody>
           <!-- Usando a função foreach para percorrer o array de usuarios -->
           <% usuarios.forEach((usuario) => { %>
            <tr>
                <td><%= usuario.id %> </td>
                <td><%= usuario.usuario %> </td>
                <td><%= usuario.email %> </td>
                <td><%= usuario.tipo %> </td>
                <td>
                    <!-- botão de editar -->
                     <a href="/usuarios/<%= usuario.id %>" style="text-decoration: none;">
                        <button class="btn btn-sm btn-warning me-2">
                            <i class="bi bi-pencil-square"></i>
                            editar
                        </button>
                     </a>
                    <!-- botão de excluir -->
                     <a href="#">
                        <button class="btn btn-sm btn-danger" onclick="confirmaExclusao('<%= usuario.usuario %>','<%= usuario.id %>')">
                            <i class="bi bi-trash3"></i>
                            excluir
                        </button>
                     </a>
                </td>
            </tr>
           <% }) %>
        </tbody>
       </table>
      <% } else { %>
        <div class="alert alert-danger text-center mt-5">
            nenhum usuário cadastrado no momento
        </div>
     <% } %>

     <!-- Criação do script para função deletar -->
      <script>
        function confirmaExclusao(nomeUsuario, id){
            if (confirm(`Deseja realmente excluir o usuário ${nomeUsuario}`)) {
                window.location.href = `/usuarios/deletar/${id}`
            }
        }
      </script>
</main>

<!-- Rodape de todas as paginas -->
<%- include('../partials/footer') %>